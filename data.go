package main

import (
	"encoding/json"
	"github.com/360EntSecGroup-Skylar/excelize"
	"github.com/semicircle/gozhszht"
	"log"
	"os"
	"regexp"
	"sort"
	"strconv"
	"strings"
)

const (
	EquipmentDataFile   = "./equipment.json"
	ApplicationDataFile = "./application.json"
	CharacterDataFile   = "./character.json"
)

var MapCache map[string][]Equipment
var ApplicationCache map[string]interface{}
var equipments []Equipment
var characters []Character

func isNum(s string) bool {
	_, err := strconv.ParseFloat(s, 64)
	return err == nil
}

func t2s(text string) string {
	return gozhszht.ToSimple(text)
	//cc, err := gocc.New("t2s")
	//if err != nil {
	//	log.Println(err)
	//	return ""
	//}
	//res, err := cc.Convert(text)
	//if err != nil {
	//	log.Println(err)
	//	return ""
	//}
	//return res
}

//æ ¹æ®excelåŒæ­¥è§’è‰²ä¿¡æ¯
func SyncCharacterDataFromExcel() {
	characters := map[int]interface{}{
		1000: []string{"æœªçŸ¥è§’è‰²", "æœªçŸ¥ã‚­ãƒ£ãƒ©", "Unknown"},
		1001: []string{"æ—¥å’Œ", "ãƒ’ãƒ¨ãƒª", "Hiyori", "æ—¥å’Œè‰", "çŒ«æ‹³", "ğŸ±ğŸ‘Š"},
		1002: []string{"ä¼˜è¡£", "ãƒ¦ã‚¤", "Yui", "ç§ç”°", "æ™®ç”°", "ç”±è¡£", "ç»“è¡£", "ue", "â†—â†˜â†—â†˜"},
		1003: []string{"æ€œ", "ãƒ¬ã‚¤", "Rei", "å‰‘åœ£", "æ™®æ€œ", "ä¼¶"},
		1004: []string{"ç¦Š", "ãƒŸã‚½ã‚®", "Misogi", "æœªå¥å¸Œ", "ç‚¸å¼¹", "ç‚¸å¼¹äºº", "ğŸ’£"},
		1005: []string{"èŒ‰è‰", "ãƒãƒ„ãƒª", "Matsuri", "è·³è·³è™", "è€è™", "è™", "ğŸ…"},
		1006: []string{"èŒœé‡Œ", "ã‚¢ã‚«ãƒª", "Akari", "å¦¹æ³•", "å¦¹å¦¹æ³•"},
		1007: []string{"å®«å­", "ãƒŸãƒ¤ã‚³", "Miyako", "å¸ƒä¸", "å¸ƒ", "ğŸ®"},
		1008: []string{"é›ª", "ãƒ¦ã‚­", "Yuki", "å°é›ª", "é•œå­", "é•œæ³•", "ä¼ªå¨˜", "ç”·å­©å­", "ç”·å­©çº¸", "é›ªå“¥"},
		1009: []string{"æå¥ˆ", "ã‚¢ãƒ³ãƒŠ", "Anna", "ä¸­äºŒ", "ç…¤æ°”ç½"},
		1010: []string{"çœŸæ­¥", "ãƒãƒ›", "Maho", "ç‹ç‹¸", "çœŸæ‰", "å’•å™œçµæ³¢", "çœŸå¸ƒ", "ğŸ¦Š"},
		1011: []string{"ç’ƒä¹ƒ", "ãƒªãƒ", "Rino", "å¦¹å¼“"},
		1012: []string{"åˆéŸ³", "ãƒãƒ„ãƒ", "Hatsune", "hego", "æ˜Ÿæ³•", "æ˜Ÿæ˜Ÿæ³•", "â­æ³•", "ç¡æ³•"},
		1013: []string{"ä¸ƒä¸ƒé¦™", "ãƒŠãƒŠã‚«", "Nanaka", "å¨œå¨œå¡", "77k", "77é¦™"},
		1014: []string{"éœ", "ã‚«ã‚¹ãƒŸ", "ä¾¦æ¢", "æœå®¾çŠ¬", "é©´", "é©´å­", "ğŸ”"},
		1015: []string{"ç¾é‡Œ", "ãƒŸã‚µãƒˆ", "Misato", "åœ£æ¯"},
		1016: []string{"é“ƒå¥ˆ", "ã‚¹ã‚ºãƒŠ", "Suzuna", "æš´å‡»å¼“", "æš´å¼“", "çˆ†å‡»å¼“", "çˆ†å¼“", "æ”¿å§”"},
		1017: []string{"é¦™ç»‡", "ã‚«ã‚ªãƒª", "Kaori", "ç‰çƒçŠ¬", "ç‹—å­", "ç‹—", "ç‹—æ‹³", "ğŸ¶", "ğŸ•", "ğŸ¶ğŸ‘ŠğŸ»", "ğŸ¶ğŸ‘Š"},
		1018: []string{"ä¼Šç»ª", "ã‚¤ã‚ª", "Io", "è€å¸ˆ", "é­…é­”"},

		1020: []string{"ç¾ç¾", "ãƒŸãƒŸ", "Mimi", "å…”å­", "å…”å…”", "å…”å‰‘", "èåœéœ¸æ–­å‰‘", "äººå‚éœ¸æ–­å‰‘", "å¤©å…”éœ¸æ–­å‰‘", "ğŸ‡", "ğŸ°"},
		1021: []string{"èƒ¡æ¡ƒ", "ã‚¯ãƒ«ãƒŸ", "Kurumi", "é“ƒé“›", "ğŸ””"},
		1022: []string{"ä¾é‡Œ", "ãƒ¨ãƒª", "Yori", "å§æ³•", "å§å§æ³•"},
		1023: []string{"ç»«éŸ³", "ã‚¢ãƒ¤ãƒ", "Ayane", "ç†Šé”¤", "ğŸ»ğŸ”¨", "ğŸ»"},

		1025: []string{"é“ƒè“", "ã‚¹ã‚ºãƒ¡", "Suzume", "å¥³ä»†", "å¦¹æŠ–"},
		1026: []string{"é“ƒ", "ãƒªãƒ³", "Rin", "æ¾é¼ ", "ğŸ¿", "ğŸ¿ï¸"},
		1027: []string{"æƒ ç†å­", "ã‚¨ãƒªã‚³", "Eriko", "ç—…å¨‡"},
		1028: []string{"å’²æ‹", "ã‚µãƒ¬ãƒ³", "Saren", "å……ç”µå®", "é’æ¢…ç«¹é©¬", "å¹¼é©¯æŸ“", "é™¢é•¿", "å›­é•¿", "ğŸ”‹", "æ™®ç”µ"},
		1029: []string{"æœ›", "ãƒã‚¾ãƒŸ", "Nozomi", "å¶åƒ", "å°æœ›", "ğŸ¤"},
		1030: []string{"å¦®è¯º", "æ‰‡å­", "ãƒ‹ãƒãƒ³", "Ninon", "å¦®ä¾¬"},
		1031: []string{"å¿", "ã‚·ãƒãƒ–", "Shinobu", "æ™®å¿", "é¬¼çˆ¶", "ğŸ’€"},
		1032: []string{"ç§‹ä¹ƒ", "ã‚¢ã‚­ãƒ", "Akino", "å“ˆå“ˆå‰‘"},
		1033: []string{"çœŸé˜³", "ãƒãƒ’ãƒ«", "Mahiru", "å¥¶ç‰›", "ğŸ„", "ğŸ®", "çœŸâ˜€"},
		1034: []string{"ä¼˜èŠ±æ¢¨", "ãƒ¦ã‚«ãƒª", "Yukari", "ç”±åŠ è‰", "é»„éª‘", "é…’é¬¼", "å¥¶éª‘", "åœ£éª‘", "ğŸº", "ğŸºğŸ‘»"},

		1036: []string{"é•œå", "ã‚­ãƒ§ã‚¦ã‚«", "Kyouka", "å°ä»“å”¯", "xcw", "å°è‹å”¯", "8å²", "å…«å²", "å–·æ°´è", "å…«å²å–·æ°´è", "8å²å–·æ°´è"},
		1037: []string{"æ™º", "ãƒˆãƒ¢", "Tomo", "åœæ¯›"},
		1038: []string{"æ ", "ã‚·ã‚ªãƒª", "Shiori", "tpå¼“", "å°æ ", "ç™½è™å¼“", "ç™½è™å¦¹"},

		1040: []string{"ç¢§", "ã‚¢ã‚ªã‚¤", "Aoi", "é¦™èœ", "é¦™èœå¼“", "ç»¿æ¯›å¼“", "æ¯’å¼“", "ç»¿å¸½å¼“", "ç»¿å¸½"},

		1042: []string{"åƒæ­Œ", "ãƒã‚«", "Chika", "ç»¿æ¯›å¥¶"},
		1043: []string{"çœŸç´", "ãƒã‚³ãƒˆ", "Makoto", "ç‹¼", "ğŸº", "æœˆæœˆ", "æœ‹", "ç‹¼å§"},
		1044: []string{"ä¼Šè‰äºš", "ã‚¤ãƒªãƒ¤", "Iriya", "ä¼Šåˆ©äºš", "ä¼Šè‰é›…", "ä¼Šåˆ©é›…", "yly", "å¸è¡€é¬¼", "é‚£ä¸ªå¥³äºº"},
		1045: []string{"ç©ºèŠ±", "ã‚¯ã‚¦ã‚«", "Kuuka", "æŠ–m", "æŠ–"},
		1046: []string{"ç å¸Œ", "ã‚¿ãƒã‚­", "Tamaki", "çŒ«å‰‘", "ğŸ±å‰‘", "ğŸ±ğŸ—¡ï¸"},
		1047: []string{"çº¯", "ã‚¸ãƒ¥ãƒ³", "Jun", "é»‘éª‘", "saber"},
		1048: []string{"ç¾å†¬", "ãƒŸãƒ•ãƒ¦", "Mifuyu", "å­é¾™", "èµµå­é¾™", "æ³³è£…ç¾å†¬"},
		1049: []string{"é™æµ", "ã‚·ã‚ºãƒ«", "Shizuru", "å§å§"},
		1050: []string{"ç¾å’²", "ãƒŸã‚µã‚­", "Misaki", "å¤§çœ¼", "ğŸ‘€", "ğŸ‘ï¸", "ğŸ‘"},
		1051: []string{"æ·±æœˆ", "ãƒŸãƒ„ã‚­", "Mitsuki", "çœ¼ç½©", "æŠ–s", "åŒ»ç”Ÿ"},
		1052: []string{"è‰ç›", "ãƒªãƒ", "Rima", "Lima", "è‰æ³¥é©¬", "ç¾Šé©¼", "ğŸ¦™", "ğŸ"},
		1053: []string{"è«å¦®å¡", "ãƒ¢ãƒ‹ã‚«", "Monika", "æ¯›äºŒåŠ›"},
		1054: []string{"çººå¸Œ", "ãƒ„ãƒ ã‚®", "Tsumugi", "è£ç¼", "èœ˜è››ä¾ ", "ğŸ•·ï¸", "ğŸ•¸ï¸"},
		1055: []string{"æ­¥æœª", "ã‚¢ãƒ¦ãƒŸ", "Ayumi", "æ­¥ç¾", "è·¯äºº", "è·¯äººå¦¹"},
		1056: []string{"æµå¤", "ãƒ«ã‚«", "Ruka", "å¤§å§", "å¤§å§å¤´", "å„¿åŠ›", "luka", "åˆ˜å¤"},
		1057: []string{"å‰å¡”", "ã‚¸ãƒ¼ã‚¿", "Jiita", "å§¬å¡”", "å›¢é•¿", "å‰ä»–", "ğŸ¸", "éª‘ç©ºå£«", "qks"},
		1058: []string{"è´ªåƒä½©å¯", "ãƒšã‚³ãƒªãƒ¼ãƒŒ", "Pecoriinu", "ä½©å¯è‰å§†", "åƒè´§", "ä½©å¯", "å…¬ä¸»", "é¥­å›¢", "ğŸ™"},
		1059: []string{"å¯å¯è", "ã‚³ãƒƒã‚³ãƒ­", "Kokkoro", "å¯å¯ç½—", "å¦ˆ", "æ™®ç™½"},
		1060: []string{"å‡¯ç•™", "ã‚­ãƒ£ãƒ«", "Kyaru", "å‡¯éœ²", "ç™¾åœ°å¸Œç•™è€¶", "å¸Œç•™è€¶", "Kiruya", "é»‘çŒ«", "è‡­é¼¬", "æ™®é»‘", "æ¥å¤´éœ¸ç‹", "è¡—å¤´éœ¸ç‹"},
		1061: []string{"çŸ›ä¾æœª", "ãƒ ã‚¤ãƒŸ", "Muimi", "è¯ºç»´å§†", "Noemu", "å¤å¨œ", "511", "æ— æ„ä¹‰", "å¤©æ¥¼éœ¸æ–­å‰‘", "å§†å’ª", "æ¯å’ª"},

		1063: []string{"äºšé‡Œè", "ã‚¢ãƒªã‚µ", "Arisa", "é¸­æ¢¨ç", "çå­", "äºšé‡Œæ²™", "é¸­æ¢¨å‚»", "äºšä¸½è", "äºšè‰è", "çå­å¼“", "ğŸğŸ¦", "yls"},

		1065: []string{"å˜‰å¤œ", "ã‚«ãƒ¤", "Kaya", "æ†¨æ†¨é¾™", "é¾™æ‹³", "ğŸ²ğŸ‘ŠğŸ»", "ğŸ‰ğŸ‘ŠğŸ»", "æ¥é¾™ç¬¨æ¯”", "é¬¼é“å˜‰å¤œ"},
		1066: []string{"ç¥ˆæ¢¨", "ã‚¤ãƒãƒª", "Inori", "æ¢¨è€å…«", "æè€å…«", "é¾™é”¤", "ğŸ²ğŸ”¨"},
		1067: []string{"ç©—å¸Œ", "ãƒ›ãƒãƒ¬", "Homare"},
		1068: []string{"æ‹‰æ¯”æ—æ–¯è¾¾", "ãƒ©ãƒ“ãƒªã‚¹ã‚¿", "Rabirisuta", "è¿·å®«å¥³ç‹", "æ¨¡ç´¢è·¯æ™¶", "æ¨¡ç´¢è·¯", "æ™¶"},
		1069: []string{"çœŸé‚£", "ãƒãƒŠ", "Mana", "éœ¸ç³çš‡å¸", "åƒé‡ŒçœŸé‚£", "åƒé‡Œ", "éœ¸ç³", "éœ¸é“œ"},
		1070: []string{"ä¼¼ä¼¼èŠ±", "ãƒãƒã‚«", "Neneka", "å˜è²Œå¤§å¦ƒ", "ç°å£«å®ä¼¼ä¼¼èŠ±", "ç¾å£«å®Ÿä¼¼ã€…èŠ±", "ç¾å£«å®Ÿ", "ç°å£«å®", "nnk", "448", "ææå¡", "å˜è²Œ", "å¤§å¦ƒ"},
		1071: []string{"å…‹è‰ä¸æå¨œ", "ã‚¯ãƒªã‚¹ãƒ†ã‚£ãƒ¼ãƒŠ", "Kurisutiina", "èª“çº¦å¥³å›", "å…‹è‰ä¸æå¨œÂ·æ‘©æ ¹", "Christina", "Cristina", "å…‹æ€»", "å¥³å¸", "å…‹", "æ‘©æ ¹"},
		1072: []string{"å¯èçˆ¹", "é•·è€", "Chourou", "å²³çˆ¶", "çˆ·çˆ·"},
		1073: []string{"æ‹‰åŸºæ‹‰åŸº", "ãƒ©ã‚¸ãƒ‹ã‚«ãƒ¼ãƒ³ãƒˆ", "Rajinigaanto", "è·³è·ƒç‹", "Rajiraji", "Lajilaji", "åƒåœ¾åƒåœ¾", "æ•™æˆ"},

		1075: []string{"è´ªåƒä½©å¯(å¤æ—¥)", "ãƒšã‚³ãƒªãƒ¼ãƒŒ(ã‚µãƒãƒ¼)", "Pekoriinu(Summer)", "ä½©å¯è‰å§†(å¤æ—¥)", "æ°´åƒ", "æ°´é¥­", "æ°´åƒè´§", "æ°´ä½©å¯", "æ°´å…¬ä¸»", "æ°´é¥­å›¢", "æ°´ğŸ™", "æ³³åƒ", "æ³³é¥­", "æ³³åƒè´§", "æ³³ä½©å¯", "æ³³å…¬ä¸»", "æ³³é¥­å›¢", "æ³³ğŸ™", "æ³³è£…åƒè´§", "æ³³è£…å…¬ä¸»", "æ³³è£…é¥­å›¢", "æ³³è£…ğŸ™", "ä½©å¯(å¤æ—¥)", "ğŸ¥¡", "ğŸ‘™ğŸ™", "æ³¼å¦‡"},
		1076: []string{"å¯å¯è(å¤æ—¥)", "ã‚³ãƒƒã‚³ãƒ­(ã‚µãƒãƒ¼)", "Kokkoro(Summer)", "æ°´ç™½", "æ°´å¦ˆ", "æ°´å¯", "æ°´å¯å¯", "æ°´å¯å¯è", "æ°´å¯å¯ç½—", "æ³³è£…å¦ˆ", "æ³³è£…å¯å¯è", "æ³³è£…å¯å¯ç½—"},
		1077: []string{"é“ƒè“(å¤æ—¥)", "ã‚¹ã‚ºãƒ¡(ã‚µãƒãƒ¼)", "Suzume(Summer)", "æ°´å¥³ä»†", "æ°´å¦¹æŠ–"},
		1078: []string{"å‡¯ç•™(å¤æ—¥)", "ã‚­ãƒ£ãƒ«(ã‚µãƒãƒ¼)", "Kyaru(Summer)", "å‡¯éœ²(å¤æ—¥)", "æ°´é»‘", "æ°´é»‘çŒ«", "æ°´è‡­é¼¬", "æ³³è£…é»‘çŒ«", "æ³³è£…è‡­é¼¬", "æ½¶", "æº´", "ğŸ’§é»‘"},
		1079: []string{"ç å¸Œ(å¤æ—¥)", "ã‚¿ãƒã‚­(ã‚µãƒãƒ¼)", "Tamaki(Summer)", "æ°´çŒ«å‰‘", "æ°´çŒ«", "æ³³çŒ«", "æ¸µ", "ğŸ’§ğŸ±ğŸ—¡ï¸", "æ°´ğŸ±ğŸ—¡ï¸"},
		1080: []string{"ç¾å†¬(å¤æ—¥)", "ãƒŸãƒ•ãƒ¦(ã‚µãƒãƒ¼)", "Mifuyu(Summer)", "æ°´å­é¾™", "æ°´ç¾å†¬"},
		1081: []string{"å¿(ä¸‡åœ£èŠ‚)", "ã‚·ãƒãƒ–(ãƒãƒ­ã‚¦ã‚£ãƒ³)", "Shinobu(Halloween)", "ä¸‡åœ£å¿", "ç“œå¿", "ğŸƒå¿", "ğŸƒğŸ’€"},
		1082: []string{"å®«å­(ä¸‡åœ£èŠ‚)", "ãƒŸãƒ¤ã‚³(ãƒãƒ­ã‚¦ã‚£ãƒ³)", "Miyako(Halloween)", "ä¸‡åœ£å®«å­", "ä¸‡åœ£å¸ƒä¸", "ç‹¼ä¸", "ç‹¼å¸ƒä¸", "ä¸‡åœ£ğŸ®", "ğŸºğŸ®", "ğŸƒğŸ®", "ğŸ‘»ğŸ®"},
		1083: []string{"ç¾å’²(ä¸‡åœ£èŠ‚)", "ãƒŸã‚µã‚­(ãƒãƒ­ã‚¦ã‚£ãƒ³)", "Misaki(Halloween)", "ä¸‡åœ£ç¾å’²", "ä¸‡åœ£å¤§çœ¼", "ç“œçœ¼", "ğŸƒçœ¼", "ğŸƒğŸ‘€", "ğŸƒğŸ‘ï¸", "ğŸƒğŸ‘"},
		1084: []string{"åƒæ­Œ(åœ£è¯èŠ‚)", "ãƒã‚«(ã‚¯ãƒªã‚¹ãƒã‚¹)", "Chika(Xmas)", "åœ£è¯åƒæ­Œ", "åœ£åƒ", "è›‹é¸½", "ğŸ„ğŸ’°ğŸ¶", "ğŸ„åƒğŸ¶", "ğŸ„1000ğŸ¶"},
		1085: []string{"èƒ¡æ¡ƒ(åœ£è¯èŠ‚)", "ã‚¯ãƒ«ãƒŸ(ã‚¯ãƒªã‚¹ãƒã‚¹)", "Kurumi(Xmas)", "åœ£è¯èƒ¡æ¡ƒ", "åœ£è¯é“ƒé“›"},
		1086: []string{"ç»«éŸ³(åœ£è¯èŠ‚)", "ã‚¢ãƒ¤ãƒ(ã‚¯ãƒªã‚¹ãƒã‚¹)", "Ayane(Xmas)", "åœ£è¯ç†Šé”¤", "è›‹é”¤", "åœ£é”¤", "ğŸ„ğŸ»ğŸ”¨", "ğŸ„ğŸ»", "åœ£è¯ç†Šæ§Œ"},
		1087: []string{"æ—¥å’Œ(æ–°å¹´)", "ãƒ’ãƒ¨ãƒª(ãƒ‹ãƒ¥ãƒ¼ã‚¤ãƒ¤ãƒ¼)", "Hiyori(NewYear)", "æ–°å¹´æ—¥å’Œ", "æ˜¥çŒ«", "ğŸ‘˜ğŸ±"},
		1088: []string{"ä¼˜è¡£(æ–°å¹´)", "ãƒ¦ã‚¤(ãƒ‹ãƒ¥ãƒ¼ã‚¤ãƒ¤ãƒ¼)", "Yui(NewYear)", "æ–°å¹´ä¼˜è¡£", "æ˜¥ç”°", "æ–°å¹´ç”±è¡£"},
		1089: []string{"æ€œ(æ–°å¹´)", "ãƒ¬ã‚¤(ãƒ‹ãƒ¥ãƒ¼ã‚¤ãƒ¤ãƒ¼)", "Rei(NewYear)", "æ˜¥å‰‘", "æ˜¥æ€œ", "æ˜¥ä¼¶", "æ–°æ˜¥å‰‘åœ£", "æ–°å¹´æ€œ", "æ–°å¹´å‰‘åœ£"},
		1090: []string{"æƒ ç†å­(æƒ…äººèŠ‚)", "ã‚¨ãƒªã‚³(ãƒãƒ¬ãƒ³ã‚¿ã‚¤ãƒ³)", "Eriko(Valentine)", "æƒ…äººèŠ‚ç—…å¨‡", "æ‹ç—…", "æƒ…ç—…", "æ‹ç—…å¨‡", "æƒ…ç—…å¨‡"},
		1091: []string{"é™æµ(æƒ…äººèŠ‚)", "ã‚·ã‚ºãƒ«(ãƒãƒ¬ãƒ³ã‚¿ã‚¤ãƒ³)", "Shizuru(Valentine)", "æƒ…äººèŠ‚é™æµ", "æƒ…å§", "æƒ…äººèŠ‚å§å§"},
		1092: []string{"å®‰", "ã‚¢ãƒ³", "An", "èƒ–å®‰", "55kg"},
		1093: []string{"éœ²", "ãƒ«ã‚¥", "Ruu", "é€ƒè¯¾å¥³ç‹"},
		1094: []string{"å¤è•¾å¨…", "ã‚°ãƒ¬ã‚¢", "Gurea", "é¾™å§¬", "å¤é›·å¨…", "å¤è•¾äºš", "å¤é›·äºš", "å¤è•¾é›…", "ğŸ²ğŸ”", "ğŸ‰ğŸ”"},
		1095: []string{"ç©ºèŠ±(å¤§æ±Ÿæˆ·)", "ã‚¯ã‚¦ã‚«(ã‚ªãƒ¼ã‚¨ãƒ‰)", "Kuuka(Ooedo)", "æ±Ÿæˆ·ç©ºèŠ±", "æ±Ÿæˆ·æŠ–m", "æ±Ÿm", "èŠ±m", "æ±ŸèŠ±"},
		1096: []string{"å¦®è¯º(å¤§æ±Ÿæˆ·)", "ãƒ‹ãƒãƒ³(ã‚ªãƒ¼ã‚¨ãƒ‰)", "Ninon(Ooedo)", "æ±Ÿæˆ·æ‰‡å­", "å¿æ‰‡"},
		1097: []string{"é›·å§†", "ãƒ¬ãƒ ", "Remu", "è•¾å§†"},
		1098: []string{"æ‹‰å§†", "ãƒ©ãƒ ", "Ramu"},
		1099: []string{"çˆ±èœœè‰é›…", "ã‚¨ãƒŸãƒªã‚¢", "Emiria", "è‰¾ç±³è‰äºš", "emt", "çˆ±èœœè‰äºš", "EMT"},
		1100: []string{"é“ƒå¥ˆ(å¤æ—¥)", "ã‚¹ã‚ºãƒŠ(ã‚µãƒãƒ¼)", "Suzuna(Summer)", "ç€‘å‡»å¼“", "æ°´çˆ†", "æ°´çˆ†å¼“", "æ°´æš´", "ç€‘", "æ°´æš´å¼“", "ç€‘å¼“", "æ³³è£…æš´å¼“", "æ³³è£…çˆ†å¼“"},
		1101: []string{"ä¼Šç»ª(å¤æ—¥)", "ã‚¤ã‚ª(ã‚µãƒãƒ¼)", "Io(Summer)", "æ°´é­…é­”", "æ°´è€å¸ˆ", "æ³³è£…é­…é­”", "æ³³è£…è€å¸ˆ"},
		1102: []string{"ç¾å’²(å¤æ—¥)", "ãƒŸã‚µã‚­(ã‚µãƒãƒ¼)", "Misaki(Summer)", "æ°´å¤§çœ¼", "æ³³è£…å¤§çœ¼"},
		1103: []string{"å’²æ‹(å¤æ—¥)", "ã‚µãƒ¬ãƒ³(ã‚µãƒãƒ¼)", "Saren(Summer)", "æ°´ç”µ", "æ³³è£…å……ç”µå®", "æ³³è£…å’²æ‹", "æ°´ç€å’²æ‹", "æ°´ç”µç«™", "æ°´ç”µå®", "æ°´å……", "ğŸ‘™ğŸ”‹"},
		1104: []string{"çœŸç´(å¤æ—¥)", "ãƒã‚³ãƒˆ(ã‚µãƒãƒ¼)", "Makoto(Summer)", "æ°´ç‹¼", "æµª", "æ°´ğŸº", "æ³³ç‹¼", "æ³³æœˆ", "æ³³æœˆæœˆ", "æ³³æœ‹", "æ°´æœˆ", "æ°´æœˆæœˆ", "æ°´æœ‹", "ğŸ‘™ğŸº"},
		1105: []string{"é¦™ç»‡(å¤æ—¥)", "ã‚«ã‚ªãƒª(ã‚µãƒãƒ¼)", "Kaori(Summer)", "æ°´ç‹—", "æ³ƒ", "æ°´ğŸ¶", "æ°´ğŸ•", "æ³³ç‹—"},
		1106: []string{"çœŸæ­¥(å¤æ—¥)", "ãƒãƒ›(ã‚µãƒãƒ¼)", "æ³³è£…çœŸæ­¥", "Maho(Summer)", "æ°´ç‹ç‹¸", "æ°´ç‹", "æ°´å£¶", "æ°´çœŸæ­¥", "æ°´maho", "æ°µğŸ¦Š", "æ°´ğŸ¦Š", "ğŸ’§ğŸ¦Š"},
		1107: []string{"ç¢§(æ’ç­ç”Ÿ)", "ã‚¢ã‚ªã‚¤(ç·¨å…¥ç”Ÿ)", "Aoi(Hennyuusei)", "ç”Ÿèœ", "æ’ç­ç¢§", "å­¦é™¢ç¢§"},
		1108: []string{"å…‹èä¾", "ã‚¯ãƒ­ã‚¨", "Kuroe", "åå“¥", "é»‘æ±Ÿ", "é»‘æ±ŸèŠ±å­", "èŠ±å­"},
		1109: []string{"çªçˆ±å„¿", "ãƒã‚¨ãƒ«", "Chieru", "åˆ‡éœ²", "èŒ„éœ²", "èŒ„å™œ", "åˆ‡å™œ"},
		1110: []string{"ä¼˜å¦®", "ãƒ¦ãƒ‹", "Yuni", "çœŸè¡Œå¯ºç”±ä»", "ç”±ä»", "ä¼˜å°¼", "u2", "ä¼˜å¦®è¾ˆå…ˆ", "è¾ˆå…ˆ", "ä¹¦è®°", "uni", "å…ˆè¾ˆ", "ä»™è´", "æ²¹è…»", "ä¼˜å¦®å…ˆè¾ˆ", "å­¦å§", "18å²é»‘ä¸å­¦å§"},
		1111: []string{"é•œå(ä¸‡åœ£èŠ‚)", "ã‚­ãƒ§ã‚¦ã‚«(ãƒãƒ­ã‚¦ã‚£ãƒ³)", "Kyouka(Halloween)", "ä¸‡åœ£é•œå", "ä¸‡åœ£å°ä»“å”¯", "ä¸‡åœ£xcw", "çŒ«ä»“å”¯", "é»‘çŒ«ä»“å”¯", "mcw", "çŒ«å”¯", "çŒ«ä»“", "å–µå”¯"},
		1112: []string{"ç¦Š(ä¸‡åœ£èŠ‚)", "ãƒŸã‚½ã‚®(ãƒãƒ­ã‚¦ã‚£ãƒ³)", "Misogi(Halloween)", "ä¸‡åœ£ç¦Š", "ä¸‡åœ£ç‚¸å¼¹äºº", "ç“œç‚¸å¼¹äºº", "ä¸‡åœ£ç‚¸å¼¹", "ä¸‡åœ£ç‚¸", "ç“œç‚¸", "å—ç“œç‚¸", "ğŸƒğŸ’£"},
		1113: []string{"ç¾ç¾(ä¸‡åœ£èŠ‚)", "ãƒŸãƒŸ(ãƒãƒ­ã‚¦ã‚£ãƒ³)", "Mimi(Halloween)", "ä¸‡åœ£å…”", "ä¸‡åœ£å…”å­", "ä¸‡åœ£å…”å…”", "ç»·å¸¦å…”", "ç»·å¸¦å…”å­", "ä¸‡åœ£ç¾ç¾", "ç»·å¸¦ç¾ç¾", "ä¸‡åœ£ğŸ°", "ç»·å¸¦ğŸ°", "ğŸƒğŸ°", "ä¸‡åœ£ğŸ‡", "ç»·å¸¦ğŸ‡", "ğŸƒğŸ‡"},
		1114: []string{"éœ²å¨œ", "ãƒ«ãƒŠ", "Runa", "Luna", "éœ²ä»“å”¯", "éœ²cw"},
		1115: []string{"å…‹è‰ä¸æå¨œ(åœ£è¯èŠ‚)", "ã‚¯ãƒªã‚¹ãƒ†ã‚£ãƒ¼ãƒŠ(ã‚¯ãƒªã‚¹ãƒã‚¹)", "Kurisutiina(Xmas)", "Christina(Xmas)", "Cristina(Xmas)", "åœ£è¯å…‹", "åœ£è¯å…‹æ€»", "åœ£è¯å¥³å¸", "è›‹å…‹", "åœ£å…‹", "å¿…èƒœå®¢"},
		1116: []string{"æœ›(åœ£è¯èŠ‚)", "ãƒã‚¾ãƒŸ(ã‚¯ãƒªã‚¹ãƒã‚¹)", "Nozomi(Xmas)", "åœ£è¯æœ›", "åœ£è¯å¶åƒ", "è›‹å¶åƒ", "è›‹æœ›"},
		1117: []string{"ä¼Šè‰äºš(åœ£è¯èŠ‚)", "ã‚¤ãƒªãƒ¤(ã‚¯ãƒªã‚¹ãƒã‚¹)", "Iriya(Xmas)", "åœ£è¯ä¼Šè‰äºš", "åœ£è¯ä¼Šåˆ©äºš", "åœ£è¯ä¼Šè‰é›…", "åœ£è¯ä¼Šåˆ©é›…", "åœ£è¯yly", "åœ£è¯å¸è¡€é¬¼", "åœ£ä¼Š", "åœ£yly"},

		1119: []string{"å¯å¯è(æ–°å¹´)", "ã‚³ãƒƒã‚³ãƒ­(ãƒ‹ãƒ¥ãƒ¼ã‚¤ãƒ¤ãƒ¼)", "Kokkoro(NewYear)", "æ˜¥å¦ˆ", "æ˜¥å¯å¯", "æ˜¥ç™½", "æ–°å¹´å¦ˆ", "æ–°å¯"},
		1120: []string{"å‡¯ç•™(æ–°å¹´)", "ã‚­ãƒ£ãƒ«(ãƒ‹ãƒ¥ãƒ¼ã‚¤ãƒ¤ãƒ¼)", "Kyaru(NewYear)", "å‡¯éœ²(æ–°å¹´)", "æ˜¥å‡¯ç•™", "æ˜¥é»‘çŒ«", "æ˜¥é»‘", "æ˜¥è‡­é¼¬", "æ–°å¹´å‡¯ç•™", "æ–°å¹´é»‘çŒ«", "æ–°å¹´è‡­é¼¬", "å”¯ä¸€ç¥"},
		1121: []string{"é“ƒè“(æ–°å¹´)", "ã‚¹ã‚ºãƒ¡(ãƒ‹ãƒ¥ãƒ¼ã‚¤ãƒ¤ãƒ¼)", "Suzume(NewYear)", "æ˜¥é“ƒè“", "æ˜¥å¥³ä»†", "æ˜¥å¦¹æŠ–", "æ–°å¹´é“ƒè“", "æ–°å¹´å¥³ä»†", "æ–°å¹´å¦¹æŠ–"},
		1122: []string{"éœ(é­”æ³•å°‘å¥³)", "ã‚«ã‚¹ãƒŸ(ãƒã‚¸ã‚«ãƒ«)", "é­”æ³•å°‘å¥³éœ", "é­”æ³•ä¾¦æ¢", "é­”æ³•æœå®¾çŠ¬", "é­”æ³•é©´", "é­”æ³•é©´å­", "é­”é©´", "é­”æ³•éœ", "é­”æ³•å°‘é©´"},
		1123: []string{"æ (é­”æ³•å°‘å¥³)", "ã‚·ã‚ªãƒª(ãƒã‚¸ã‚«ãƒ«)", "Shiori(MagiGirl)", "é­”æ³•å°‘å¥³æ ", "é­”æ³•tpå¼“", "é­”æ³•å°æ ", "é­”æ³•ç™½è™å¼“", "é­”æ³•ç™½è™å¦¹", "é­”æ³•ç™½è™", "é­”æ ", "é­”æ³•æ "},
		1124: []string{"å¯æœˆ(NGs)", "ã‚¦ãƒ…ã‚­(ãƒ‡ãƒ¬ãƒã‚¹)", "Udsuki(DEREM@S)", "å¯æœˆ", "åµç”¨", "Udsuki(DEREMAS)", "å²›æ‘å¯æœˆ"},
		1125: []string{"å‡›(å¶åƒå¤§å¸ˆ)", "å‡›(NGs)", "ãƒªãƒ³(ãƒ‡ãƒ¬ãƒã‚¹)", "Rin(DEREM@S)", "å‡›", "Rin(DEREMAS)", "æ¶©è°·å‡›", "è¥¿éƒ¨å‡›"},
		1126: []string{"æœªå¤®(NGs)", "ãƒŸã‚ª(ãƒ‡ãƒ¬ãƒã‚¹)", "Mio(DEREM@S)", "æœªå¤®", "Mio(DEREMAS)", "æœ¬ç”°æœªå¤®"},
		1127: []string{"é“ƒ(æ¸¸ä¾ )", "ãƒªãƒ³(ãƒ¬ãƒ³ã‚¸ãƒ£ãƒ¼)", "é“ƒ(è‡ªå«é˜Ÿ)", "Rin(Ranger)", "éª‘å…µæ¾é¼ ", "æ¸¸ä¾ æ¾é¼ ", "æ¸¸éª‘å…µæ¾é¼ ", "æŠ¤æ—å‘˜æ¾é¼ ", "æŠ¤æ—æ¾é¼ ", "æ¸¸ä¾ ğŸ¿ï¸", "æ­¦æ¾"},
		1128: []string{"çœŸé˜³(æ¸¸ä¾ )", "ãƒãƒ’ãƒ«(ãƒ¬ãƒ³ã‚¸ãƒ£ãƒ¼)", "çœŸé˜³(è‡ªå«é˜Ÿ)", "Mahiru(Ranger)", "éª‘å…µå¥¶ç‰›", "æ¸¸ä¾ å¥¶ç‰›", "æ¸¸éª‘å…µå¥¶ç‰›", "æŠ¤æ—å‘˜å¥¶ç‰›", "æŠ¤æ—å¥¶ç‰›", "æ¸¸ä¾ ğŸ„", "æ¸¸ä¾ ğŸ®", "ç‰›å‰"},
		1129: []string{"ç’ƒä¹ƒ(å¥‡å¹»)", "ãƒªãƒ(ãƒ¯ãƒ³ãƒ€ãƒ¼)", "Rino(Wonder)", "ç’ƒä¹ƒ(å¥‡å¢ƒ)", "ç’ƒä¹ƒ(ä»™å¢ƒ)", "çˆ½å¼“", "çˆ±ä¸½ä¸å¼“", "çˆ±å¼“", "å…”å¼“", "å¥‡å¢ƒå¦¹å¼“", "å¥‡å¹»å¦¹å¼“", "å¥‡å¹»ç’ƒä¹ƒ", "ä»™å¢ƒå¦¹å¼“", "ç™½ä¸å¦¹å¼“", "çˆ±ä¸½ä¸å¦¹å¼“"},
		1130: []string{"æ­¥æœª(å¥‡å¹»)", "ã‚¢ãƒ¦ãƒŸ(ãƒ¯ãƒ³ãƒ€ãƒ¼)", "Ayumi(Wonder)", "æ­¥æœª(å¥‡å¢ƒ)", "æ­¥æœª(ä»™å¢ƒ)", "è·¯äººå…”", "å…”äººå¦¹", "çˆ±ä¸½ä¸è·¯äºº", "å¥‡å¢ƒè·¯äºº", "å¥‡å¹»è·¯äºº", "å¥‡å¹»æ­¥æœª", "ä»™å¢ƒè·¯äºº"},
		1131: []string{"æµå¤(å¤æ—¥)", "ãƒ«ã‚«(ã‚µãƒãƒ¼)", "Ruka(Summer)", "æ³³è£…æµå¤", "æ°´æµå¤", "æ³³è£…åˆ˜å¤", "æ°´åˆ˜å¤", "æ³³è£…å¤§å§", "æ³³è£…å¤§å§å¤´", "æ°´å¤§å§", "æ°´å¤§å§å¤´", "æ°´å„¿åŠ›", "æ³³è£…å„¿åŠ›", "æ°´æµ"},
		1132: []string{"æå¥ˆ(å¤æ—¥)", "ã‚¢ãƒ³ãƒŠ(ã‚µãƒãƒ¼)", "Anna(Summer)", "æ³³è£…ä¸­äºŒ", "æ³³è£…ç…¤æ°”ç½", "æ°´ä¸­äºŒ", "æ°´ç…¤æ°”ç½", "å†²", "å†²äºŒ"},
		1133: []string{"ä¸ƒä¸ƒé¦™(å¤æ—¥)", "ãƒŠãƒŠã‚«(ã‚µãƒãƒ¼)", "Nanaka(Summer)", "æ³³è£…å¨œå¨œå¡", "æ³³è£…77k", "æ³³è£…77é¦™", "æ°´å¨œå¨œå¡", "æ°´77k", "æ°´77é¦™", "æ°´ä¸ƒä¸ƒé¦™", "æ³³è£…ä¸ƒä¸ƒé¦™"},
		1134: []string{"æ³³è£…åˆéŸ³", "åˆéŸ³(å¤æ—¥)", "ãƒãƒ„ãƒ(ã‚µãƒãƒ¼)", "Hatsune(Summer)", "æ°´æ˜Ÿ", "æµ·æ˜Ÿ", "æ°´hego", "æ°´æ˜Ÿæ³•", "æ³³è£…æ˜Ÿæ³•", "æ°´â­æ³•", "æ°´ç¡æ³•", "æ¹¦"},
		1135: []string{"ç¾é‡Œ(å¤æ—¥)", "æ³³è£…ç¾é‡Œ", "ãƒŸã‚µãƒˆ(ã‚µãƒãƒ¼)", "Misato(Summer)", "æ°´æ¯", "æ³³è£…åœ£æ¯", "æ°´åœ£æ¯"},
		1136: []string{"çº¯(å¤æ—¥)", "ã‚¸ãƒ¥ãƒ³(ã‚µãƒãƒ¼)", "Jun(Summer)", "æ³³è£…é»‘éª‘", "æ°´é»‘éª‘", "æ³³è£…çº¯", "æ°´çº¯", "å°æ¬¡éƒ"},
		1137: []string{"èŒœé‡Œ(å¤©ä½¿)", "ã‚¢ã‚«ãƒª(ã‚¨ãƒ³ã‚¸ã‚§ãƒ«)", "Akari(Angel)", "å¤©ä½¿å¦¹æ³•", "å¤©ä½¿èŒœé‡Œ", "ä¸˜æ¯”ç‰¹å¦¹æ³•"},
		1138: []string{"ä¾é‡Œ(å¤©ä½¿)", "ãƒ¨ãƒª(ã‚¨ãƒ³ã‚¸ã‚§ãƒ«)", "Yori(Angel)", "å¤©ä½¿å§æ³•", "å¤©ä½¿ä¾é‡Œ", "ä¸˜æ¯”ç‰¹å§æ³•"},
		1139: []string{"çººå¸Œ(ä¸‡åœ£èŠ‚)", "ãƒ„ãƒ ã‚®(ãƒãƒ­ã‚¦ã‚£ãƒ³)", "Tsumugi(Halloween)", "ä¸‡åœ£è£ç¼", "ä¸‡åœ£èœ˜è››ä¾ ", "ğŸƒğŸ•·ï¸", "ğŸƒğŸ•¸ï¸", "ä¸‡è£", "ç“œè£", "é¬¼è£", "é¬¼æ‰"},
		1140: []string{"æ€œ(ä¸‡åœ£èŠ‚)", "ãƒ¬ã‚¤(ãƒãƒ­ã‚¦ã‚£ãƒ³)", "Rei(Halloween)", "ä¸‡åœ£å‰‘åœ£", "ä¸‡å‰‘", "ç“œå‰‘", "ç“œæ€œ", "ä¸‡åœ£æ€œ"},
		1141: []string{"èŒ‰è‰(ä¸‡åœ£èŠ‚)", "ãƒãƒ„ãƒª(ãƒãƒ­ã‚¦ã‚£ãƒ³)", "Matsuri(Halloween)", "ä¸‡åœ£è·³è·³è™", "ä¸‡åœ£è€è™", "ç“œè™", "ğŸƒğŸ…"},

		//# =================================== #
		1701: []string{"ç¯å¥ˆ", "ã‚«ãƒ³ãƒŠ", "Kanna", "æ¡¥æœ¬ç¯å¥ˆ", "çº¢äºŒåŠ›", "æ¯›å¤§åŠ›", "æ¯›å°åŠ›", "æ¯›å…­åŠ›", "å¯å¤§è", "å¤§å¯è", "ç¼åˆæ€ª"},

		//# =================================== #

		1802: []string{"å…¬ä¸»ä¼˜ä¾", "å…¬ä¼˜", "ä¼˜è¡£(å…¬ä¸»)", "ãƒ¦ã‚¤(ãƒ—ãƒªãƒ³ã‚»ã‚¹)", "Yui(Princess)", "å…¬ä¸»ä¼˜è¡£", "å…¬ä¸»yui", "å…¬ä¸»ç§ç”°", "å…¬ä¸»ç”°", "å…¬ä¸»ue", "æ‰æ¯›ä¼˜è¡£", "æ‰æ¯›yui", "æ‰æ¯›ue", "æ‰æ¯›", "é£ç¿¼ä¼˜è¡£", "é£ç¿¼ue", "é£ç¿¼", "é£ç¿¼é«˜è¾¾", "é£ç”°"},

		1804: []string{"è´ªåƒä½©å¯(å…¬ä¸»)", "ãƒšã‚³ãƒªãƒ¼ãƒŒ(ãƒ—ãƒªãƒ³ã‚»ã‚¹)", "Pekoriinu(Princess)", "å…¬ä¸»åƒ", "å…¬ä¸»é¥­", "å…¬ä¸»åƒè´§", "å…¬ä¸»ä½©å¯", "å…¬ä¸»é¥­å›¢", "å…¬ä¸»ğŸ™", "å‘½è¿é«˜è¾¾", "é«˜è¾¾", "å‘½è¿å…¬ä¸»", "é«˜è¾¾å…¬ä¸»", "å‘½åƒ", "æ˜¥å“¥é«˜è¾¾", "ğŸ¤–ğŸ™", "ğŸ¤–"},
		1805: []string{"å¯å¯è(å…¬ä¸»)", "ã‚³ãƒƒã‚³ãƒ­ï¼ˆãƒ—ãƒªãƒ³ã‚»ã‚¹ï¼‰", "Kokkoro(Princess)", "å…¬ä¸»å¦ˆ", "æœˆå…‰å¦ˆ", "è¶å¦ˆ", "è´è¶å¦ˆ", "æœˆå…‰è¶å¦ˆ", "å…¬ä¸»å¯", "å…¬ä¸»å¯è", "å…¬ä¸»å¯å¯è", "æœˆå…‰å¯", "æœˆå…‰å¯è", "æœˆå…‰å¯å¯è", "è¶å¯", "è¶å¯è", "è¶å¯å¯è"},

		//# =================================== #
		1900: []string{"çˆ±æ¢…æ–¯", "ã‚¢ãƒ¡ã‚¹", "Amesu", "è²æ¬§", "ãƒ•ã‚£ã‚ª", "Fio"},

		1907: []string{"å¤§å¤", "ã‚¿ã‚¤ã‚´", "Taigo", "å¤§å¾", "é¬¼é“å¤§å¾"},
		1908: []string{"èŠ±å‡›", "ã‚«ãƒªãƒ³", "Karin", "ç»¿æ¯›æ¶é­”"},
		1909: []string{"æ¶…æ¯”äºš", "ãƒãƒ“ã‚¢", "Nevia", "Nebia"},
		1910: []string{"çœŸå´", "ãƒã‚µã‚­", "Masaki"},
		1911: []string{"ç±³æ¶…å°”Î²", "ãƒŸãƒãƒ«Î²", "MineruBeta", "ç±³æ¶…å°”", "ãƒŸãƒãƒ«", "Mineru"},

		1914: []string{"è±ªç»…", "ã‚´ã‚¦ã‚·ãƒ³", "Goushin"},
		1915: []string{"å…‹é‡Œå‰å¡”", "ã‚¯ãƒ¬ã‚¸ãƒƒã‚¯", "Kurejikku"},
		1916: []string{"åŸºæ´›", "ã‚­ã‚¤ãƒ­", "Kiiro"},
		1917: []string{"å–„", "ã‚¼ãƒ¼ãƒ³", "Seen"},
		1918: []string{"å…°æ³•", "ãƒ©ãƒ³ãƒ•ã‚¡", "Ranfa"},
		1919: []string{"é˜¿ä½å°”å¾·", "ã‚¢ãƒ³ã‚¾ãƒ¼ãƒ«ãƒ‰", "Anzoorudo"},
		1920: []string{"ç¾ç©º", "ãƒŸã‚½ãƒ©", "Misora"},

		//# =================================== #
		4031: []string{"éª·é«…", "é«‘é«", "Dokuro", "éª·é«…è€çˆ¹", "è€çˆ¹"},

		9000: []string{"ç¥æ ‘", "ãƒ¦ã‚¦ã‚­", "Yuuki", "éª‘å£«", "éª‘å£«å›"},
	}

	log.SetPrefix("[PCR]")
	log.SetFlags(log.Ldate | log.Lshortfile)
	xlsx, err := excelize.OpenFile("./RANK.xlsx")
	if err != nil {
		log.Println(err)
		return
	}
	rows := xlsx.GetRows(xlsx.GetSheetMap()[1])
	c := 0

	cache := make(map[int]bool)

	var characterList []Character

	for i, row := range rows {
		distance := xlsx.GetCellValue(xlsx.GetSheetMap()[1], "C"+strconv.Itoa(i))
		if isNum(distance) {
			name := strings.Replace(t2s(row[3]), "\n", " ", -1)
			if len(name) == 0 {
				continue
			}
			oc := c
			for _, realName := range strings.Split(name, " ") {
				if len(realName) == 0 {
					continue
				}
				for k, v := range characters {
					_, ok := cache[k]
					if ok {
						continue
					}
					vs := v.([]string)
					for _, s := range vs {
						if strings.Compare(s, realName) == 0 {
							c += 1
							cache[k] = true
							//å»é™¤é‡å¤çš„åå­—
							names := strings.Split(name, " ")
							res1 := ""
							res2 := strings.Join(vs, "")
							for _, n := range names {
								if !strings.Contains(res2, n) {
									res1 += n
								}
							}
							//è¿‡æ»¤éä¸­æ–‡çš„æ˜µç§°
							//åªå–ä¸¤ä¸ª
							res2 = ""
							rc := 0
							var hzRegexp = regexp.MustCompile("^[\u4e00-\u9fa5].*$")
							for _, n := range vs {
								if hzRegexp.MatchString(n) {
									res2 += n
									rc += 1
								}
								if rc == 2 {
									break
								}
							}
							name = res1 + res2
							_distance, _ := strconv.ParseFloat(distance, 64)
							characterList = append(characterList, Character{
								Id:             int64(k),
								Name:           name,
								RealName:       names[0],
								Distance:       int64(_distance),
								Rank:           row[6],
								Star:           row[7],
								UnionEquipment: row[8],
								Inform:         strings.Replace(row[9], "\n", " ", -1),
							})
							break
						}
					}
					if oc != c {
						break
					}
				}
				if oc != c {
					break
				}
			}
		}
	}
	InitCharacterDataFile(characterList)
}

func InitCharacterDataFile(_characters []Character) {
	filePtr, err := os.Create(CharacterDataFile)
	if err != nil {
		log.Println("characteræ–‡ä»¶åˆ›å»ºå¤±è´¥", err.Error())
		return
	}
	defer filePtr.Close()
	encoder := json.NewEncoder(filePtr)
	err = encoder.Encode(_characters)
	if err != nil {
		log.Println("characterç¼–ç é”™è¯¯", err.Error())
	} else {
		log.Println("characterç¼–ç æˆåŠŸ")
	}
	copy(characters, _characters)
}

func InitEquipmentDataInfoFromJsonFile() {
	MapCache = make(map[string][]Equipment)
	ApplicationCache = make(map[string]interface{})
	var err error

	//æ–‡ä»¶è¯»å–
	filePtr, err := os.Open(EquipmentDataFile)
	if err != nil {
		log.Println("equipmentæ–‡ä»¶æ‰“å¼€å¤±è´¥", err.Error())
		return
	}
	defer filePtr.Close()
	decoder := json.NewDecoder(filePtr)
	err = decoder.Decode(&equipments)
	if err != nil {
		log.Println("è¯»å–equipmentæ–‡ä»¶é”™è¯¯", err.Error())
	} else {
		log.Println("è¯»å–equipmentæ–‡ä»¶æˆåŠŸ")
	}

	//æ–‡ä»¶è¯»å–
	filePtr, err = os.Open(ApplicationDataFile)
	if err != nil {
		log.Println("applicationæ–‡ä»¶æ‰“å¼€å¤±è´¥", err.Error())
		return
	}
	defer filePtr.Close()
	decoder = json.NewDecoder(filePtr)
	err = decoder.Decode(&ApplicationCache)
	if err != nil {
		log.Println("è¯»å–applicationæ–‡ä»¶é”™è¯¯", err.Error())
	} else {
		log.Println("è¯»å–applicationæ–‡ä»¶æˆåŠŸ")
	}

	//è§’è‰²ä¿¡æ¯è¯»å–
	filePtr, err = os.Open(CharacterDataFile)
	if err != nil {
		log.Println("characteræ–‡ä»¶æ‰“å¼€å¤±è´¥", err.Error())
		return
	}
	defer filePtr.Close()
	decoder = json.NewDecoder(filePtr)
	err = decoder.Decode(&characters)
	if err != nil {
		log.Println("è¯»å–characteræ–‡ä»¶é”™è¯¯", err.Error())
	} else {
		log.Println("è¯»å–characteræ–‡ä»¶æˆåŠŸ")
	}

	if err == nil {
		for _, equipment := range equipments {
			var temp map[string]string //æ‰è½åœ°å›¾
			if err := json.Unmarshal([]byte(equipment.Map), &temp); err == nil {
				for key, value := range temp {
					tV, _ := strconv.ParseInt(value[:len(value)-1], 10, 8)
					tK := strings.Replace(key, "\t", "", -1) //åœ°å›¾å
					var tempEquipment = Equipment{
						Id:       equipment.Id,
						Title:    equipment.Title,
						Hot:      equipment.Hot,
						Url:      equipment.Url,
						Priority: tV,
					}
					if MapCache[tK] == nil {
						MapCache[tK] = []Equipment{tempEquipment}
					} else {
						t := append(MapCache[tK], tempEquipment)
						MapCache[tK] = t
					}
				}
			}
		}
		//æ ¹æ®çˆ†ç‡æ’åº
		for _, value := range MapCache {
			sort.Sort(EquipmentSlice(value))
		}
	}
}

func SyncEquipmentDataCompareWithDataBaseAndJson() {
	var es []Equipment
	compile := regexp.MustCompile(`\d.*\.png$`)
	Dao.Select("id,title,hot,id,map,url").Order("hot DESC").Find(&es, "enable = 1")
	for _, e := range es {
		for i := 0; i < len(equipments); i++ {
			if equipments[i].Id == e.Id {
				equipments[i].Map = e.Map
				e.Hot = equipments[i].Hot
				_id := compile.FindStringSubmatch(e.Url)[0]
				e.Id, _ = strconv.ParseInt(_id[:len(_id)-4], 10, 64)
				equipments[i].Id = e.Id
				Dao.Model(&e).Update("hot", e.Hot)
			}
		}
	}
	UpdateEquipmentJson()
}

//æ›´æ–°æœ¬åœ°jsonæ–‡ä»¶
func UpdateEquipmentJson() {
	//æ ¹æ®çƒ­åº¦æ’åº
	sort.Sort(EquipmentHotSlice(equipments))

	//ä¿å­˜equipment
	filePtr, err := os.OpenFile(EquipmentDataFile, os.O_WRONLY|os.O_TRUNC|os.O_CREATE, 0644)
	if err != nil {
		log.Println("equipmentæ–‡ä»¶è¯»å–å¤±è´¥", err.Error())
		return
	}
	encoder := json.NewEncoder(filePtr)
	err = encoder.Encode(equipments)
	if err != nil {
		log.Println("æ›´æ–°equipmentæ–‡ä»¶é”™è¯¯", err.Error())
	} else {
		log.Println("æ›´æ–°equipmentæ–‡ä»¶æˆåŠŸ")
	}
	_ = filePtr.Close()

	//ä¿å­˜application
	filePtr, err = os.OpenFile(ApplicationDataFile, os.O_WRONLY|os.O_TRUNC|os.O_CREATE, 0644)
	if err != nil {
		log.Println("applicationæ–‡ä»¶è¯»å–å¤±è´¥", err.Error())
		return
	}
	encoder = json.NewEncoder(filePtr)
	err = encoder.Encode(ApplicationCache)
	if err != nil {
		log.Println("æ›´æ–°applicationæ–‡ä»¶é”™è¯¯", err.Error())
	} else {
		log.Println("æ›´æ–°applicationæ–‡ä»¶æˆåŠŸ")
	}
	_ = filePtr.Close()

}

func UpdateApplicationJson() {
	//ä¿å­˜application
	filePtr, err := os.OpenFile(ApplicationDataFile, os.O_WRONLY|os.O_TRUNC|os.O_CREATE, 0644)
	if err != nil {
		log.Println("applicationæ–‡ä»¶è¯»å–å¤±è´¥", err.Error())
		return
	}
	encoder := json.NewEncoder(filePtr)
	err = encoder.Encode(ApplicationCache)
	if err != nil {
		log.Println("æ›´æ–°applicationæ–‡ä»¶é”™è¯¯", err.Error())
	} else {
		log.Println("æ›´æ–°applicationæ–‡ä»¶æˆåŠŸ")
	}
	_ = filePtr.Close()

}
